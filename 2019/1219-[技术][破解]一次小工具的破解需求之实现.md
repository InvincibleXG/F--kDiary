# 吹嘘帖——小工具的伪破解需求被我花了二十分钟搞定了！

今天工作上的事情有了不错的进展，于是心情大好，上来写点博客吹吹水！

**事先声明** ，因为涉及隐私和机密，后面不会说太详细，如果有类似的需求可以同我交流，非常欢迎。另外也希望这种实现需求的思路能给老铁们一点启发。

**「需求」** ：

有一个加密通信的小工具，暂时不知道是啥语言开发的，已经打包成exe可执行文件了，但是设计上有一些粗心——在窗口的标题栏上会显示出对方的 IP地址，可是窗口的 size和dimension 被定死了，无法拖拉和zoom in/out，这样就导致有些 稍长的IP地址 会显示不全，末尾被自动变成 “...” 隐藏了。而我们对这个 IP地址 实际上是相当感兴趣的，因此需求就是 「使IP地址完全显示在窗口(标题栏)上」。

**「思路与实践」** :

因为此工具很小，逻辑必然不会太复杂，首先想到的就是通过反编译直接修改源码，从而实现我们的目的。那么直接使用反编译软件对此exe进行解析，可以发现对应窗口的静态资源，并且找到「疑似」配置加载逻辑的汇编代码。修改了窗口的大小以后，重新打包，运行——发现了尴尬的问题，因为是加密通信软件，必然要走服务器，修改软件就被服务器校验到了，直接关闭无法运行。

果然，其实这类加密通信软件，是会考虑到一定的安全性的，有较复杂的加密校验模块会对软件进行版本检测，如果发现软件被反编译修改，则会报错终止运行。那么我们就得另辟蹊径了，因为无法修改窗口的配置代码、显示字体等等。那么既然无法改动程序本身，那该怎么办呢？调整windows的分辨率和字体吗？

于是我开始了对windows系统的分辨率和字体的魔改，一度直接爆撸了注册表里的十六进制神秘码，仍然徒劳无功，这块我有点疑问，可能是字体不够小？毕竟字体的大小是十六进制数字，似乎不是连续的，不敢乱改，还是想想别的办法吧！（主要考虑上班中，不能顾此失彼，尽量取巧不要花太多时间。如果有大佬对这块显示有所了解，欢迎指导）

那么再回到这个软件的设计层面，既然是可视化软件，必然在开发上会分为「静态显示资源」（窗体、按钮、图片、文本）和「代码底层逻辑」，那么是否会有静态资源是可以修改的？并且会影响到窗口的大小、宽度等属性以实现我们的需求呢？我便开始在软件的根目录搜索各种静态文件，找到大部分都是一些图片、xml配置、日志等。

**「终结」** :

然而在我最终一筹莫展的时候，我开启了“显示隐藏文件”，意外地发现了一个 xxxxx.ini 配置文件！内容结构跟我们熟悉的 mysql的配置文件my.ini 非常相似！惊喜的是，直接看到了我们想获取的 IP 标题！但是我们最最感兴趣的是 IP 的内容，而这部分是 用 **%s** 做了代替，看来程序运行时会加载并进行动态替换！这下直接打开了突破口，因为这部分之前还有若干中文字符，中文字符显示相比 ASCII 字符会更加占位置，那我就机智的删除掉前面这些中文字符，由于是修改的 ini 配置文件，保存以后再运行程序，并没有被检验出异常！并且实现了我们想要的，IP 地址内容即使是 255.255.255.255 这种最大长度也能完全显示出来了！「满足ing」



对这次伪破解的需求实现，我想总结出来的一点就是：软件问题的解决还是要回到其设计上，如果设计良好配置灵活那自然好说，但是如果设计不周，必然还会有可以突破的入口，从多种方面来寻找这种突破口，也许就能花费很小的代价就解决了需求。