# RocketMQ 相关

### Tags

Tags是Topic下的次级消息类型（注：Tags也支持`TagA || TagB`这样的表达式），可以在同一个Topic下基于Tags进行消息过滤。Tags的过滤需要经过两次比对，首先会在Broker端通过Tag hashcode进行一次比对过滤，匹配成功传到consumer端后再对具体Tags进行比对，以防止Tag hashcode重复的情况。



1. 一个应用尽可能只使用一个 Topic，消息子类型用 tags 来标识，tags 可以由应用自由设置。只有发送消息设置了tags，消费方在订阅消息时，才可以利用 tags 在 broker 做消息过滤。
2. 同一组消费者，订阅的 Topic-tags 必须相同，否则此消费组适用的tags将被后启动的消费者覆盖。
3. 每个消息在业务层面的唯一标识码，要设置到 keys 字段，方便将来定位消息丢失问题。服务器会为每个消息创建哈希索引，应用可以通过 Topic+key 来查询返条消息内容，以及消息被谁消费。由于是哈希索引，请务必保证 key 尽可能唯一，这样可以避免潜在的哈希冲突。
4. 消息发送成功或者失败，要打印消息日志，务必要打印 send result 和 key 字段。
5. 对于消息不可丢失应用，务必要有消息重发机制。例如：消息发送失败，存储到数据库，能有定时程序尝试重发或者人工触发重发。
6. 某些应用如果不关注消息是否发送成功，请直接使用`sendOneWay`方法发送消息。

